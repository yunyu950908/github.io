---
title: XSS 跨站脚本攻击
tags:
  - XSS 攻击
  - HTTP
categories:
  - HTTP
date: 2017-09-23 15:19:21
---
# XSS 漏洞

## 1、什么是 XSS

XSS（ Cross-Site Scripting）跨站脚本攻击

- 简单来说
1. 正常用户 A 提交正常内容，显示在另一个用户 B 的网页上，没有问题。

2. 恶意用户 H 提交恶意内容，显示在另一个用户 B 的网页上，对 B 的网页随意篡改。

- 造成 XSS 有几个要点：

1. 恶意用户可以提交内容

2. 提交的内容可以显示在另一个用户的页面上

3. 这些内容未经过滤，直接运行在另一个用户的页面上

- 举个栗子
假设我们有一个评论系统，恶意用户 H 提交评论`<script>console.log(document.cookie)</script>`，而服务器没有对这段代码进行过滤，直接放行。然后用户 B 来访问网站，这段脚本在 B 的浏览器直接执行，恶意用户 H 的脚本就可以任意操作 B 的 cookie，而 B 对此毫无察觉。有了 cookie，恶意用户 H 就可以伪造 B 的登录信息，随意访问 B 的隐私了。而 B 始终被蒙在鼓里。

## 2、XSS 成因

形成 XSS 漏洞的主要成因有以下两个：

- 后台模板问题
后台输出代码的时候没有将可疑的符号（如 `<,>,&`等）转换成 HTML 编码，没有任何过滤而直接输出，形成 XSS 漏洞。

- 前端代码问题
前端使用 `innerHtml`  等方式插入字符，如果插入的是 HTML 标签，客户端会直接执行。当然 `eval` 也可能导致同样的问题，也是我们需要避免使用的。

## 3、XSS 防御

通过以上介绍我们了解了 XSS 攻击的基本原理，下面介绍如何做 XSS 防御：

- 后台模板
过滤所有可疑字符，将其转换成 HTML 编码再输出。

| 可疑字符   | HTML 编码    |
|--------|------------|
| <      | `&lt;`     |
| >      | `&gt;`     |
| &      | `&amp;`    |
| "      | `&quot;`   |
| （此处空格） | `&nbsp;`   |
| 其他可疑字符 | `&#ASCII码` |

- 前端代码
尽量避免使用 `innerHtml` 或 `eval` 这种危险的方式运行代码，没准你的用户就会利用这些 JS 方法的特殊性，在你的网站上嵌入一些恶意的脚本，从而对你的网站及你的客户造成不利影响。

（完）